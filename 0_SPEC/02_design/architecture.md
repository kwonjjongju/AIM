# 시스템 아키텍처
## 업무 개선 보드 시스템

---

## 1. 전체 아키텍처

```
┌─────────────────────────────────────────────────────────────────┐
│                         클라이언트 계층                          │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐             │
│  │   Desktop   │  │   Mobile    │  │   Tablet    │             │
│  │   Browser   │  │   Browser   │  │   Browser   │             │
│  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘             │
└─────────┼────────────────┼────────────────┼────────────────────┘
          │                │                │
          └────────────────┼────────────────┘
                           │ HTTPS
┌──────────────────────────┼─────────────────────────────────────┐
│                     프론트엔드 계층                              │
│  ┌────────────────────────────────────────────────────────┐    │
│  │                    React SPA                           │    │
│  │  ┌─────────┐ ┌──────────┐ ┌────────┐ ┌────────┐      │    │
│  │  │  Auth   │ │Dashboard │ │ Board  │ │ Admin  │      │    │
│  │  │ Module  │ │  Module  │ │ Module │ │ Module │      │    │
│  │  └─────────┘ └──────────┘ └────────┘ └────────┘      │    │
│  └────────────────────────────────────────────────────────┘    │
└──────────────────────────┬─────────────────────────────────────┘
                           │ REST API
┌──────────────────────────┼─────────────────────────────────────┐
│                      백엔드 계층                                 │
│  ┌────────────────────────────────────────────────────────┐    │
│  │                  Node.js + Express                     │    │
│  │  ┌─────────┐ ┌──────────┐ ┌────────┐ ┌────────┐      │    │
│  │  │  Auth   │ │   Item   │ │  User  │ │  Dept  │      │    │
│  │  │Controller│ │Controller│ │Controller│ │Controller│    │    │
│  │  └────┬────┘ └────┬─────┘ └────┬───┘ └────┬───┘      │    │
│  │       └───────────┴────────────┴──────────┘           │    │
│  │                        │                              │    │
│  │  ┌────────────────────────────────────────────────┐   │    │
│  │  │              Service Layer                     │   │    │
│  │  └────────────────────┬───────────────────────────┘   │    │
│  └───────────────────────┼───────────────────────────────┘    │
└──────────────────────────┼─────────────────────────────────────┘
                           │
┌──────────────────────────┼─────────────────────────────────────┐
│                      데이터 계층                                 │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐         │
│  │  PostgreSQL  │  │    Redis     │  │ File Storage │         │
│  │   (Main DB)  │  │(Cache/Session)│  │ (Attachments)│         │
│  └──────────────┘  └──────────────┘  └──────────────┘         │
└────────────────────────────────────────────────────────────────┘
```

---

## 2. 컴포넌트 설계

### 2.1 프론트엔드 컴포넌트

| 모듈 | 설명 | 주요 컴포넌트 |
|------|------|---------------|
| Auth | 인증 관련 | LoginPage, AuthGuard |
| Dashboard | 대시보드 | DashboardPage, StatsSummary, DeptChart |
| Board | 보드/카드 | BoardPage, DeptTabs, CardGrid, ImprovementCard |
| Admin | 관리자 | AdminPage, UserManagement, DeptManagement |
| Common | 공통 | Button, Modal, Input, StatusBadge |

### 2.2 백엔드 컴포넌트

| 레이어 | 역할 | 주요 클래스 |
|--------|------|-------------|
| Controller | 요청 처리 | AuthController, ItemController, UserController |
| Service | 비즈니스 로직 | AuthService, ItemService, UserService |
| Repository | 데이터 접근 | Prisma Client |
| Middleware | 공통 처리 | AuthMiddleware, ErrorHandler, Logger |

---

## 3. 데이터 흐름

### 3.1 항목 등록 흐름

```
[사용자] 
    │
    │ 1. 등록 폼 입력
    ▼
[React: CreateItemModal]
    │
    │ 2. POST /api/v1/items
    ▼
[Express: ItemController]
    │
    │ 3. 유효성 검증
    ▼
[ItemService]
    │
    │ 4. 비즈니스 로직
    ▼
[Prisma Client]
    │
    │ 5. INSERT INTO improvement_items
    ▼
[PostgreSQL]
    │
    │ 6. 결과 반환
    ▼
[사용자: 등록 완료]
```

### 3.2 인증 흐름

```
[로그인 요청]
    │
    ▼
[AuthController.login]
    │
    ├─→ [AuthService.validateCredentials]
    │       │
    │       ▼
    │   [비밀번호 검증 (bcrypt)]
    │
    ├─→ [JWT 토큰 생성]
    │       │
    │       ├─ Access Token (1h)
    │       └─ Refresh Token (7d)
    │
    └─→ [응답: tokens + user]
```

---

## 4. 네트워크 아키텍처

```
┌─────────────────────────────────────────────────────────────┐
│                        Internet                              │
└─────────────────────────┬───────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────────┐
│                     Nginx (Reverse Proxy)                    │
│                     - SSL Termination                        │
│                     - Static Files                           │
│                     - Load Balancing                         │
└─────────────────────────┬───────────────────────────────────┘
                          │
          ┌───────────────┼───────────────┐
          │               │               │
          ▼               ▼               ▼
┌─────────────┐   ┌─────────────┐   ┌─────────────┐
│  Frontend   │   │   Backend   │   │   Backend   │
│   (React)   │   │  (Node.js)  │   │  (Node.js)  │
│   :3000     │   │    :4000    │   │    :4001    │
└─────────────┘   └──────┬──────┘   └──────┬──────┘
                         │                 │
                         └────────┬────────┘
                                  │
                    ┌─────────────┼─────────────┐
                    │             │             │
                    ▼             ▼             ▼
              ┌──────────┐ ┌──────────┐ ┌──────────┐
              │PostgreSQL│ │  Redis   │ │  Files   │
              │  :5432   │ │  :6379   │ │ Storage  │
              └──────────┘ └──────────┘ └──────────┘
```

---

## 5. 보안 아키텍처

```
[클라이언트]
    │
    │ HTTPS (TLS 1.3)
    ▼
[Nginx]
    │
    │ SSL Termination
    ▼
[Backend API]
    │
    ├─→ [JWT 검증] ─→ 인증 실패 → 401
    │
    ├─→ [RBAC 검사] ─→ 권한 없음 → 403
    │
    ├─→ [입력 검증] ─→ 유효하지 않음 → 400
    │
    └─→ [비즈니스 로직 실행]
```

---

## 6. 확장성 고려사항

### 6.1 수평 확장
- Backend: 무상태 설계, 다중 인스턴스 지원
- Session: Redis 사용으로 세션 공유
- Database: Read Replica 지원 (향후)

### 6.2 캐싱 전략
| 대상 | 캐시 위치 | TTL |
|------|-----------|-----|
| 부서 목록 | Redis | 1일 |
| 사용자 정보 | Redis | 1시간 |
| 대시보드 통계 | Redis | 5분 |

---

**문서 버전**: 1.0  
**작성일**: 2026-01-19
